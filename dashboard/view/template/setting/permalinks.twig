{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="float-end">
        <button type="submit" form="form-permalinks" data-bs-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa-solid fa-floppy-disk"></i></button>
        <a href="{{ back }}" data-bs-toggle="tooltip" title="{{ button_back }}" class="btn btn-light"><i class="fa-solid fa-reply"></i></a>
      </div>
      <h1>{{ heading_title }}</h1>
      <ol class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
          <li class="breadcrumb-item"><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ol>
    </div>
  </div>
  <div class="container-fluid">
    <div class="card">
      <div class="card-header"><i class="fa-solid fa-link"></i> {{ text_edit }}</div>
      <div class="card-body">
        <form id="form-permalinks" action="{{ save }}" method="post" data-oc-toggle="ajax">
          <ul class="nav nav-tabs">
            <li class="nav-item"><a href="#tab-domain" data-bs-toggle="tab" class="nav-link active">{{ tab_domain }}</a></li>
            <li class="nav-item"><a href="#tab-url-structure" data-bs-toggle="tab" class="nav-link">{{ tab_url_structure }}</a></li>
            <li class="nav-item"><a href="#tab-seo" data-bs-toggle="tab" class="nav-link">{{ tab_seo }}</a></li>
            <li class="nav-item"><a href="#tab-redirects" data-bs-toggle="tab" class="nav-link">{{ tab_redirects }}</a></li>
          </ul>
          <div class="tab-content">
            <!-- Domain Settings Tab -->
            <div id="tab-domain" class="tab-pane active">
              <div class="mb-3">
                <h5><i class="fa-solid fa-globe"></i> {{ text_domain_settings }}</h5>
                <p class="text-muted">{{ help_domain_settings }}</p>
              </div>
              <div class="row mb-3">
                <label for="input-base-domain" class="col-sm-2 col-form-label">{{ entry_base_domain }}</label>
                <div class="col-sm-10">
                  <input type="text" name="config_base_domain" value="{{ config_base_domain }}" placeholder="{{ placeholder_base_domain }}" id="input-base-domain" class="form-control"/>
                  <div class="form-text">{{ help_base_domain }}</div>
                  <div id="error-base-domain" class="invalid-feedback"></div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-base-path" class="col-sm-2 col-form-label">{{ entry_base_path }}</label>
                <div class="col-sm-10">
                  <input type="text" name="config_base_path" value="{{ config_base_path }}" placeholder="{{ placeholder_base_path }}" id="input-base-path" class="form-control"/>
                  <div class="form-text">{{ help_base_path }}</div>
                  <div id="error-base-path" class="invalid-feedback"></div>
                </div>
              </div>
              <div class="row mb-3">
                <label class="col-sm-2 col-form-label">{{ text_current_url }}</label>
                <div class="col-sm-10">
                  <div class="alert alert-info">
                    <strong>{{ text_detected_url }}:</strong> <code id="current-base-url">{{ config_base_domain ? config_base_domain : 'localhost' }}{{ config_base_path ? '/' ~ config_base_path : '' }}</code>
                  </div>
                </div>
              </div>
            </div>

            <!-- URL Structure Tab -->
            <div id="tab-url-structure" class="tab-pane">
              <div class="mb-3">
                <h5><i class="fa-solid fa-link"></i> {{ text_url_structure_settings }}</h5>
                <p class="text-muted">{{ help_url_structure }}</p>
              </div>
              <div class="row mb-3">
                <label for="input-url-structure" class="col-sm-2 col-form-label">{{ entry_url_structure }}</label>
                <div class="col-sm-10">
                  <select name="config_url_structure" id="input-url-structure" class="form-select">
                    {% for structure in url_structures %}
                      <option value="{{ structure.value }}"{% if config_url_structure == structure.value %} selected{% endif %}>{{ structure.text }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">{{ help_url_structure }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-seo-url" class="col-sm-2 col-form-label">{{ entry_seo_url }}</label>
                <div class="col-sm-10">
                  <div class="form-check form-switch">
                    <input type="checkbox" name="config_seo_url" value="1" id="input-seo-url" class="form-check-input"{% if config_seo_url %} checked{% endif %}/>
                    <label class="form-check-label" for="input-seo-url">{{ text_enabled }}</label>
                  </div>
                  <div class="form-text">{{ help_seo_url }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-remove-prefixes" class="col-sm-2 col-form-label">{{ entry_remove_prefixes }}</label>
                <div class="col-sm-10">
                  <div class="form-check form-switch">
                    <input type="checkbox" name="config_remove_url_prefixes" value="1" id="input-remove-prefixes" class="form-check-input"{% if config_remove_url_prefixes %} checked{% endif %}/>
                    <label class="form-check-label" for="input-remove-prefixes">{{ text_enabled }}</label>
                  </div>
                  <div class="form-text">{{ help_remove_prefixes }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-trailing-slash" class="col-sm-2 col-form-label">{{ entry_trailing_slash }}</label>
                <div class="col-sm-10">
                  <div class="form-check form-switch">
                    <input type="checkbox" name="config_trailing_slash" value="1" id="input-trailing-slash" class="form-check-input"{% if config_trailing_slash %} checked{% endif %}/>
                    <label class="form-check-label" for="input-trailing-slash">{{ text_enabled }}</label>
                  </div>
                  <div class="form-text">{{ help_trailing_slash }}</div>
                </div>
              </div>
            </div>

            <!-- SEO Settings Tab -->
            <div id="tab-seo" class="tab-pane">
              <div class="mb-3">
                <h5><i class="fa-solid fa-magnifying-glass"></i> {{ text_seo_settings }}</h5>
                <p class="text-muted">{{ help_seo_settings }}</p>
              </div>
              <div class="row mb-3">
                <label for="input-category-format" class="col-sm-2 col-form-label">{{ entry_category_url_format }}</label>
                <div class="col-sm-10">
                  <select name="config_category_url_format" id="input-category-format" class="form-select">
                    {% for format in url_formats %}
                      <option value="{{ format.value }}"{% if config_category_url_format == format.value %} selected{% endif %}>{{ format.text }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">{{ help_category_url_format }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-product-format" class="col-sm-2 col-form-label">{{ entry_product_url_format }}</label>
                <div class="col-sm-10">
                  <select name="config_product_url_format" id="input-product-format" class="form-select">
                    {% for format in url_formats %}
                      <option value="{{ format.value }}"{% if config_product_url_format == format.value %} selected{% endif %}>{{ format.text }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">{{ help_product_url_format }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-information-format" class="col-sm-2 col-form-label">{{ entry_information_url_format }}</label>
                <div class="col-sm-10">
                  <select name="config_information_url_format" id="input-information-format" class="form-select">
                    {% for format in url_formats %}
                      <option value="{{ format.value }}"{% if config_information_url_format == format.value %} selected{% endif %}>{{ format.text }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">{{ help_information_url_format }}</div>
                </div>
              </div>
            </div>

            <!-- Redirects Tab -->
            <div id="tab-redirects" class="tab-pane">
              <div class="mb-3">
                <h5><i class="fa-solid fa-arrow-right"></i> {{ text_redirect_settings }}</h5>
                <p class="text-muted">{{ help_redirect_settings }}</p>
              </div>
              <div class="row mb-3">
                <label for="input-auto-redirect" class="col-sm-2 col-form-label">{{ entry_auto_redirect }}</label>
                <div class="col-sm-10">
                  <div class="form-check form-switch">
                    <input type="checkbox" name="config_auto_redirect" value="1" id="input-auto-redirect" class="form-check-input"{% if config_auto_redirect %} checked{% endif %}/>
                    <label class="form-check-label" for="input-auto-redirect">{{ text_enabled }}</label>
                  </div>
                  <div class="form-text">{{ help_auto_redirect }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-db-redirect-repair" class="col-sm-2 col-form-label">{{ entry_database_redirect_repair }}</label>
                <div class="col-sm-10">
                  <div class="form-check form-switch">
                    <input type="checkbox" name="config_database_redirect_repair" value="1" id="input-db-redirect-repair" class="form-check-input"{% if config_database_redirect_repair %} checked{% endif %}/>
                    <label class="form-check-label" for="input-db-redirect-repair">{{ text_enabled }}</label>
                  </div>
                  <div class="form-text">{{ help_database_redirect_repair }}</div>
                </div>
              </div>
              <div class="row mb-3">
                <label for="input-redirect-status" class="col-sm-2 col-form-label">{{ entry_redirect_status }}</label>
                <div class="col-sm-10">
                  <select name="config_redirect_status" id="input-redirect-status" class="form-select">
                    {% for status in redirect_statuses %}
                      <option value="{{ status.value }}"{% if config_redirect_status == status.value %} selected{% endif %}>{{ status.text }}</option>
                    {% endfor %}
                  </select>
                  <div class="form-text">{{ help_redirect_status }}</div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
// Update current URL display when domain/path changes
document.getElementById('input-base-domain').addEventListener('input', updateCurrentUrl);
document.getElementById('input-base-path').addEventListener('input', updateCurrentUrl);

function updateCurrentUrl() {
  const domain = document.getElementById('input-base-domain').value || 'localhost';
  const path = document.getElementById('input-base-path').value || '';
  const currentUrl = domain + (path ? '/' + path : '');
  document.getElementById('current-base-url').textContent = currentUrl;
}
</script>
{{ footer }}

